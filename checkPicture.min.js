/*
* @function for check pictures
* created by XiaoMingwei at 2021年5月27日10:10:12
* options{
*   url: '', // 当前显示图片
*   list: [], // 图片列表 可选，如果没有或者空表示只查看一张图 
* }
* git: https://github.com/sanaiself/checkPicture
* */
function checkPicture(t){function e(t,e){for(var i=[],o=0;o<t.length;o++)t[o]!==e&&i.push(t[o])
return i}var i=this
i.guid=function(){return"sa"+"xxxxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0
return("x"==t?e:3&e|8).toString(16)})},i.initPrivateOptions=function(){i.options.more=i.options.list.length>0,i.options.id=i.guid(),i.options.more&&(i.options.index=i.options.list.indexOf(i.options.url)||0),i.options.index<0&&(i.options.index=0),i.temporaryData={clickEl:null,timer:null,top:0,left:0}},i.setOptions=function(t){i.options={},i.options.url=t&&t.url?t.url:"",i.options.list=t&&t.list&&t.list.length>0?t.list:[],i.initPrivateOptions()},i.onClickCLose=function(){document.getElementsByTagName("body")[0].removeChild(i.cover)},i.initPictureStatus=function(){i.temporaryData.top=0,i.temporaryData.left=0,i.img.style.top="0",i.img.style.left="0"},i.setPictureUrl=function(t){console.log("设置图片地址:"+t),i.initPictureStatus(),i.img.setAttribute("src",t),i.img.removeAttribute("hidden")},i.enlargePicture=function(){i.img.className=i.img.className+" sa-check-picture-img-scale2"},i.narrowPicture=function(){var t=i.img.className.split(" ")||[]
i.img.className=e(t,"sa-check-picture-img-scale2").join(" ")},i.doubleClick=function(){-1===(i.img.className.split(" ")||[]).indexOf("sa-check-picture-img-scale2")?i.enlargePicture():i.narrowPicture()},i.onClickPre=function(){i.narrowPicture(),i.options.index--,i.options.index<0?(i.options.index++,alert("当前是第一张")):i.setPictureUrl(i.options.list[i.options.index])},i.onClickNext=function(){if(i.narrowPicture(),++i.options.index>=i.options.list.length)return i.options.index--,void alert("已经是最后一张了")
i.setPictureUrl(i.options.list[i.options.index])},i.checkCLickOrDouble=function(t){function e(t){"function"==typeof c[t]?c[t]():console.warn("您未设置当前操作"),clearInterval(i.temporaryData.timer),i.temporaryData.clickEl=null}function o(){i.temporaryData.timer&&clearInterval(i.temporaryData.timer),i.temporaryData.timer=setInterval(function(){e("click")},200)}var n=t.currentTarget,c={click:new Function,double:i.doubleClick}
i.temporaryData.clickEl&&n===i.temporaryData.clickEl?e("double"):(i.temporaryData.clickEl=n,o())},i.initPictureDraggable=function(t){var e=t||event,o=e.clientX,n=e.clientY
document.onmousemove=function(t){var e=t||event,c=e.clientX-o,l=e.clientY-n
i.img.style.top=i.temporaryData.top+l+"px",i.img.style.left=i.temporaryData.left+c+"px"},document.onmouseup=function(){document.onmousemove=null,document.onmouseup=null,i.temporaryData.top=parseFloat(i.img.style.top),i.temporaryData.left=parseFloat(i.img.style.left)}},i.init=function(){i.setOptions(t),i.options.url||i.options.more?(i.cover=document.createElement("div"),i.cover.id="saCheckPictures",i.cover.className="sa-check-pictures",i.cover.onmousedown=i.initPictureDraggable,i.img=document.createElement("img"),i.img.className="sa-check-picture-img",i.img.hidden=!0,i.setPictureUrl(i.options.url),i.img.onclick=i.checkCLickOrDouble,i.img.onmousedown=i.initPictureDraggable,i.img.ondragstart=function(){return!1},i.cover.appendChild(i.img),i.options.more&&(i.pre=document.createElement("div"),i.pre.className="sa-check-button sa-check-pre",i.pre.innerHTML='<svg t="1622184096227" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1116" width="64" height="64"><path d="M218.442816 513.05498m20.73513199-21.599745l0 0q20.735131-21.599745 42.33487601-0.864613l502.194064 482.091806q21.599745 20.735131 0.864614 42.334876l0 0q-20.735131 21.599745-42.334877 0.864613l-502.194064-482.091806q-21.599745-20.735131-0.86461301-42.334876Z" p-id="1117" fill="#cdcdcd"></path><path d="M763.710585-12.60292599m20.735131 21.59974499l0 0q20.735131 21.599745-0.864613 42.334876l-502.194065 482.09180599q-21.599745 20.735131-42.334876-0.86461299l0 0q-20.735131-21.599745 0.864613-42.334876l502.194065-482.091807q21.599745-20.735131 42.334876 0.864614Z" p-id="1118" fill="#cdcdcd"></path></svg>',i.pre.onclick=i.onClickPre,i.cover.appendChild(i.pre),i.next=document.createElement("div"),i.next.className="sa-check-button sa-check-next",i.next.innerHTML='<svg t="1622183911002" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2509" width="64" height="64"><path d="M805.557184 510.94502m-20.735132 21.599745l0 0q-20.735131 21.599745-42.334876 0.864613l-502.194064-482.091806q-21.599745-20.735131-0.864614-42.334876l0 0q20.735131-21.599745 42.334877-0.864613l502.194064 482.091806q21.599745 20.735131 0.864613 42.334876Z" p-id="2510" fill="#cdcdcd"></path><path d="M260.289415 1036.602926m-20.735131-21.599745l0 0q-20.735131-21.599745 0.864613-42.334876l502.194065-482.091806q21.599745-20.735131 42.334876 0.864613l0 0q20.735131 21.599745-0.864613 42.334876l-502.194065 482.091807q-21.599745 20.735131-42.334876-0.864614Z" p-id="2511" fill="#cdcdcd"></path></svg>',i.next.onclick=i.onClickNext,i.cover.appendChild(i.next)),i.close=document.createElement("div"),i.close.className="sa-check-button sa-check-close",i.close.innerHTML='<svg t="1622184756825" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2812" width="48" height="48"><path d="M583.168 523.776L958.464 148.48c18.944-18.944 18.944-50.176 0-69.12l-2.048-2.048c-18.944-18.944-50.176-18.944-69.12 0L512 453.12 136.704 77.312c-18.944-18.944-50.176-18.944-69.12 0l-2.048 2.048c-19.456 18.944-19.456 50.176 0 69.12l375.296 375.296L65.536 899.072c-18.944 18.944-18.944 50.176 0 69.12l2.048 2.048c18.944 18.944 50.176 18.944 69.12 0L512 594.944 887.296 970.24c18.944 18.944 50.176 18.944 69.12 0l2.048-2.048c18.944-18.944 18.944-50.176 0-69.12L583.168 523.776z" p-id="2813" fill="#cdcdcd"></path></svg>',i.close.onclick=i.onClickCLose,i.cover.appendChild(i.close),document.getElementsByTagName("body")[0].appendChild(i.cover)):console.error("请检查参数 options.url 或 options.list 是否存在")},i.init()}